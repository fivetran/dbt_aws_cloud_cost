{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-29T20:36:04.593069Z", "invocation_id": "2ac305f5-f846-43bc-a074-0677487b1880", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:03.453357Z", "completed_at": "2024-07-29T20:36:03.455038Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:03.461819Z", "completed_at": "2024-07-29T20:36:03.461834Z"}], "thread_id": "Thread-2", "execution_time": 0.015326976776123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.aws_cloud_cost_integration_tests.aws_cost_report", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:03.448242Z", "completed_at": "2024-07-29T20:36:03.475993Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:03.476230Z", "completed_at": "2024-07-29T20:36:03.476234Z"}], "thread_id": "Thread-1", "execution_time": 0.03001880645751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aws_cloud_cost.stg_aws_cloud_cost__report_base", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"aws_cloud_cost_docs\".\"aws_cost_report\"\n\n", "relation_name": "\"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"stg_aws_cloud_cost__report_base\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:03.477610Z", "completed_at": "2024-07-29T20:36:04.436813Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.437055Z", "completed_at": "2024-07-29T20:36:04.437061Z"}], "thread_id": "Thread-4", "execution_time": 1.039247989654541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aws_cloud_cost.stg_aws_cloud_cost__report", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"stg_aws_cloud_cost__report_base\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _file\n    \n as \n    \n    _file\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _line\n    \n as \n    \n    _line\n    \n, \n    \n    \n    _modified\n    \n as \n    \n    _modified\n    \n, \n    \n    \n    bill_bill_type\n    \n as \n    \n    bill_bill_type\n    \n, \n    \n    \n    bill_billing_entity\n    \n as \n    \n    bill_billing_entity\n    \n, \n    \n    \n    bill_billing_period_end_date\n    \n as \n    \n    bill_billing_period_end_date\n    \n, \n    \n    \n    bill_billing_period_start_date\n    \n as \n    \n    bill_billing_period_start_date\n    \n, \n    \n    \n    bill_invoice_id\n    \n as \n    \n    bill_invoice_id\n    \n, \n    \n    \n    bill_invoicing_entity\n    \n as \n    \n    bill_invoicing_entity\n    \n, \n    \n    \n    bill_payer_account_id\n    \n as \n    \n    bill_payer_account_id\n    \n, \n    \n    \n    bill_payer_account_name\n    \n as \n    \n    bill_payer_account_name\n    \n, \n    \n    \n    identity_line_item_id\n    \n as \n    \n    identity_line_item_id\n    \n, \n    \n    \n    identity_time_interval\n    \n as \n    \n    identity_time_interval\n    \n, \n    \n    \n    line_item_availability_zone\n    \n as \n    \n    line_item_availability_zone\n    \n, \n    \n    \n    line_item_blended_cost\n    \n as \n    \n    line_item_blended_cost\n    \n, \n    \n    \n    line_item_blended_rate\n    \n as \n    \n    line_item_blended_rate\n    \n, \n    \n    \n    line_item_currency_code\n    \n as \n    \n    line_item_currency_code\n    \n, \n    \n    \n    line_item_line_item_description\n    \n as \n    \n    line_item_line_item_description\n    \n, \n    \n    \n    line_item_line_item_type\n    \n as \n    \n    line_item_line_item_type\n    \n, \n    \n    \n    line_item_normalization_factor\n    \n as \n    \n    line_item_normalization_factor\n    \n, \n    \n    \n    line_item_normalized_usage_amount\n    \n as \n    \n    line_item_normalized_usage_amount\n    \n, \n    \n    \n    line_item_operation\n    \n as \n    \n    line_item_operation\n    \n, \n    \n    \n    line_item_product_code\n    \n as \n    \n    line_item_product_code\n    \n, \n    \n    \n    line_item_resource_id\n    \n as \n    \n    line_item_resource_id\n    \n, \n    \n    \n    line_item_tax_type\n    \n as \n    \n    line_item_tax_type\n    \n, \n    \n    \n    line_item_unblended_cost\n    \n as \n    \n    line_item_unblended_cost\n    \n, \n    \n    \n    line_item_unblended_rate\n    \n as \n    \n    line_item_unblended_rate\n    \n, \n    \n    \n    line_item_usage_account_id\n    \n as \n    \n    line_item_usage_account_id\n    \n, \n    \n    \n    line_item_usage_account_name\n    \n as \n    \n    line_item_usage_account_name\n    \n, \n    \n    \n    line_item_usage_amount\n    \n as \n    \n    line_item_usage_amount\n    \n, \n    \n    \n    line_item_usage_end_date\n    \n as \n    \n    line_item_usage_end_date\n    \n, \n    \n    \n    line_item_usage_start_date\n    \n as \n    \n    line_item_usage_start_date\n    \n, \n    \n    \n    line_item_usage_type\n    \n as \n    \n    line_item_usage_type\n    \n, \n    \n    \n    pricing_currency\n    \n as \n    \n    pricing_currency\n    \n, \n    \n    \n    pricing_public_on_demand_cost\n    \n as \n    \n    pricing_public_on_demand_cost\n    \n, \n    \n    \n    pricing_public_on_demand_rate\n    \n as \n    \n    pricing_public_on_demand_rate\n    \n, \n    \n    \n    pricing_purchase_option\n    \n as \n    \n    pricing_purchase_option\n    \n, \n    \n    \n    pricing_term\n    \n as \n    \n    pricing_term\n    \n, \n    \n    \n    pricing_unit\n    \n as \n    \n    pricing_unit\n    \n, \n    \n    \n    product_pricing_unit\n    \n as \n    \n    product_pricing_unit\n    \n, \n    \n    \n    product_fee_code\n    \n as \n    \n    product_fee_code\n    \n, \n    \n    \n    product_fee_description\n    \n as \n    \n    product_fee_description\n    \n, \n    \n    \n    product_from_location\n    \n as \n    \n    product_from_location\n    \n, \n    \n    \n    product_from_location_type\n    \n as \n    \n    product_from_location_type\n    \n, \n    \n    \n    product_from_region_code\n    \n as \n    \n    product_from_region_code\n    \n, \n    \n    \n    product_instance_family\n    \n as \n    \n    product_instance_family\n    \n, \n    \n    \n    product_instance_type\n    \n as \n    \n    product_instance_type\n    \n, \n    \n    \n    product_location\n    \n as \n    \n    product_location\n    \n, \n    \n    \n    product_location_type\n    \n as \n    \n    product_location_type\n    \n, \n    \n    \n    product_operation\n    \n as \n    \n    product_operation\n    \n, \n    \n    \n    product_product_name\n    \n as \n    \n    product_product_name\n    \n, \n    \n    \n    product_product_family\n    \n as \n    \n    product_product_family\n    \n, \n    \n    \n    product_region_code\n    \n as \n    \n    product_region_code\n    \n, \n    \n    \n    product_servicecode\n    \n as \n    \n    product_servicecode\n    \n, \n    \n    \n    product_to_location\n    \n as \n    \n    product_to_location\n    \n, \n    \n    \n    product_to_location_type\n    \n as \n    \n    product_to_location_type\n    \n, \n    \n    \n    product_to_region_code\n    \n as \n    \n    product_to_region_code\n    \n, \n    \n    \n    product_usagetype\n    \n as \n    \n    product_usagetype\n    \n, \n    \n    \n    reservation_amortized_upfront_cost_for_usage\n    \n as \n    \n    reservation_amortized_upfront_cost_for_usage\n    \n, \n    \n    \n    reservation_amortized_upfront_fee_for_billing_period\n    \n as \n    \n    reservation_amortized_upfront_fee_for_billing_period\n    \n, \n    \n    \n    reservation_effective_cost\n    \n as \n    \n    reservation_effective_cost\n    \n, \n    \n    \n    reservation_normalized_units_per_reservation\n    \n as \n    \n    reservation_normalized_units_per_reservation\n    \n, \n    \n    \n    reservation_number_of_reservations\n    \n as \n    \n    reservation_number_of_reservations\n    \n, \n    \n    \n    reservation_recurring_fee_for_usage\n    \n as \n    \n    reservation_recurring_fee_for_usage\n    \n, \n    \n    \n    reservation_total_reserved_normalized_units\n    \n as \n    \n    reservation_total_reserved_normalized_units\n    \n, \n    \n    \n    reservation_total_reserved_units\n    \n as \n    \n    reservation_total_reserved_units\n    \n, \n    \n    \n    reservation_units_per_reservation\n    \n as \n    \n    reservation_units_per_reservation\n    \n, \n    \n    \n    reservation_unused_amortized_upfront_fee_for_billing_period\n    \n as \n    \n    reservation_unused_amortized_upfront_fee_for_billing_period\n    \n, \n    \n    \n    reservation_unused_normalized_unit_quantity\n    \n as \n    \n    reservation_unused_normalized_unit_quantity\n    \n, \n    \n    \n    reservation_unused_quantity\n    \n as \n    \n    reservation_unused_quantity\n    \n, \n    \n    \n    reservation_unused_recurring_fee\n    \n as \n    \n    reservation_unused_recurring_fee\n    \n, \n    \n    \n    reservation_upfront_value\n    \n as \n    \n    reservation_upfront_value\n    \n, \n    \n    \n    savings_plan_amortized_upfront_commitment_for_billing_period\n    \n as \n    \n    savings_plan_amortized_upfront_commitment_for_billing_period\n    \n, \n    \n    \n    savings_plan_recurring_commitment_for_billing_period\n    \n as \n    \n    savings_plan_recurring_commitment_for_billing_period\n    \n, \n    \n    \n    savings_plan_savings_plan_effective_cost\n    \n as \n    \n    savings_plan_savings_plan_effective_cost\n    \n, \n    \n    \n    savings_plan_savings_plan_rate\n    \n as \n    \n    savings_plan_savings_plan_rate\n    \n, \n    \n    \n    savings_plan_total_commitment_to_date\n    \n as \n    \n    savings_plan_total_commitment_to_date\n    \n, \n    \n    \n    savings_plan_used_commitment\n    \n as \n    \n    savings_plan_used_commitment\n    \n\n\n\n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n    from base\n),\n\nfinal as (\n    \n    select \n        source_relation, \n        _file,\n        \n\nTRIM(BOTH '/' FROM (\n\n  \n    \n\n    split_part(\n        _file,\n        '/',\n        1\n        )\n\n\n  \n\n || '/' || \n\n  \n    \n\n    split_part(\n        _file,\n        '/',\n        2\n        )\n\n\n  \n\n)) as report,\n        _line,\n        _modified,\n        max(_modified) over(partition by bill_billing_period_start_date, source_relation) = _modified as is_latest_file_version,\n        bill_bill_type as bill_type,\n        bill_billing_entity as billing_entity,\n        bill_billing_period_start_date as billing_period_start_date,\n        bill_billing_period_end_date as billing_period_end_date,\n        bill_invoice_id as invoice_id,\n        bill_invoicing_entity as invoicing_entity,\n        bill_payer_account_id,\n        bill_payer_account_name,\n        line_item_blended_cost as blended_cost,\n        line_item_blended_rate as blended_rate,\n        line_item_currency_code as currency_code,\n        line_item_normalization_factor as normalization_factor,\n        line_item_normalized_usage_amount as normalized_usage_amount,\n        line_item_availability_zone as availability_zone,\n        line_item_line_item_description as line_item_description,\n        line_item_line_item_type as line_item_type,\n        line_item_tax_type as tax_type,\n        coalesce(line_item_operation, product_operation) as operation,\n        line_item_product_code as product_code,\n        line_item_unblended_cost as unblended_cost,\n        line_item_unblended_rate as unblended_rate,\n        line_item_usage_account_id as usage_account_id,\n        line_item_usage_account_name as usage_account_name,\n        line_item_usage_amount as usage_amount,\n        line_item_usage_end_date as usage_end_date,\n        line_item_usage_start_date as usage_start_date,\n        line_item_usage_type as usage_type,\n        pricing_public_on_demand_cost as public_on_demand_cost,\n        pricing_public_on_demand_rate as public_on_demand_rate,\n        pricing_purchase_option as purchase_option,\n        pricing_term,\n        coalesce(pricing_unit, product_pricing_unit) as pricing_unit,\n        product_fee_code, \n        product_fee_description,\n\n        -- info about product\n        product_product_name as product_name,\n        product_product_family as product_family,\n        product_servicecode as product_service_code,\n\n        -- instances \n        product_instance_type as instance_type,\n        product_instance_family as instance_family,\n\n        -- Location data for s3 buckets\n        product_location as location,\n        product_location_type as location_type,\n        product_region_code as region_code,\n\n        -- Location data for data movement (maybe remove from defaults?)\n        product_from_location as from_location,\n        product_from_location_type as from_location_type,\n        product_from_region_code as from_region_code,\n        product_to_location as to_location,\n        product_to_location_type as to_location_type,\n        product_to_region_code as to_region_code,\n\n        -- default: only include reservation + savings plan numeric fields, dimensions can be added via passthroughs\n        reservation_amortized_upfront_cost_for_usage,\n        reservation_amortized_upfront_fee_for_billing_period,\n        reservation_effective_cost,\n        reservation_number_of_reservations as number_of_reservations,\n        reservation_normalized_units_per_reservation as normalized_units_per_reservation,\n        reservation_units_per_reservation as units_per_reservation,\n        reservation_total_reserved_normalized_units as total_reserved_normalized_units,\n        reservation_total_reserved_units as total_reserved_units,\n        reservation_recurring_fee_for_usage,\n        reservation_unused_amortized_upfront_fee_for_billing_period,\n        reservation_unused_normalized_unit_quantity,\n        reservation_unused_quantity,\n        reservation_unused_recurring_fee,\n        reservation_upfront_value,\n        savings_plan_amortized_upfront_commitment_for_billing_period,\n        savings_plan_recurring_commitment_for_billing_period,\n        savings_plan_savings_plan_effective_cost as savings_plan_effective_cost,\n        savings_plan_savings_plan_rate as savings_plan_rate,\n        savings_plan_total_commitment_to_date,\n        savings_plan_used_commitment \n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final\nwhere is_latest_file_version\nand billing_period_start_date >= '1970-01-01'", "relation_name": "\"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"stg_aws_cloud_cost__report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.518067Z", "completed_at": "2024-07-29T20:36:04.547976Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.548209Z", "completed_at": "2024-07-29T20:36:04.548215Z"}], "thread_id": "Thread-2", "execution_time": 0.03085184097290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aws_cloud_cost.aws_cloud_cost__daily_overview", "compiled": true, "compiled_code": "\n\nwith source_report as (\n\n    select *\n    from \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"stg_aws_cloud_cost__report\"\n),\n\n\nusage_account_mapping as (\n\n    select \n        usage_account_id,\n        usage_account_name,\n        source_relation,\n        max(usage_start_date) as latest_start_date\n\n    from source_report\n    where usage_account_name is not null\n    group by 1,2,3\n),\n\nusage_account_names as (\n\n    select\n        sub.usage_account_id,\n        sub.usage_account_name,\n        sub.source_relation\n    from (\n        \n        select \n            usage_account_id,\n            usage_account_name,\n            source_relation,\n            row_number() over (partition by usage_account_id, source_relation order by latest_start_date desc) = 1 as is_latest_name\n        from usage_account_mapping\n    ) as sub where is_latest_name\n),\n\n\nbilling_account_mapping as (\n\n    select \n        bill_payer_account_id,\n        bill_payer_account_name,\n        source_relation,\n        max(billing_period_start_date) as latest_start_date\n\n    from source_report\n    where bill_payer_account_name is not null\n    group by 1,2,3\n),\n\nbilling_account_names as (\n\n    select\n        sub.bill_payer_account_id,\n        sub.bill_payer_account_name,\n        sub.source_relation\n    from (\n        \n        select \n            bill_payer_account_id,\n            bill_payer_account_name,\n            source_relation,\n            row_number() over (partition by bill_payer_account_id, source_relation order by latest_start_date desc) = 1 as is_latest_name\n        from billing_account_mapping\n    ) as sub where is_latest_name\n),\n\nfields as (\n\n    select \n        source_report.source_relation,\n        report, \n\n        \n        cast(date_trunc('day', usage_start_date) as date) as usage_start_date,\n        cast(date_trunc('day', usage_end_date) as date) as usage_end_date,\n        billing_period_start_date,\n        billing_period_end_date,\n\n        \n        source_report.usage_account_id,\n        coalesce(source_report.usage_account_name, usage_account_names.usage_account_name) as usage_account_name,\n        source_report.bill_payer_account_id,\n        coalesce(source_report.bill_payer_account_name, billing_account_names.bill_payer_account_name) as bill_payer_account_name,\n\n        \n        invoice_id,\n        invoicing_entity,\n        billing_entity,\n        bill_type, \n        line_item_type,\n        tax_type,\n\n        \n        purchase_option,\n        pricing_term,\n        product_fee_code,\n        product_fee_description,\n\n        \n        pricing_unit,\n        usage_type,\n        currency_code,\n        \n        \n        line_item_description,\n        product_code,\n        product_name,\n        product_service_code, -- service is within product\n        product_family,\n        operation,\n\n        \n        instance_type,\n        instance_family,\n\n        \n        location,\n        location_type,\n        region_code,\n        availability_zone,\n\n        \n        from_location,\n        from_location_type,\n        from_region_code,\n        to_location,\n        to_location_type,\n        to_region_code\n\n        \n\n\n\n,\n\n        \n        cast(sum(coalesce(usage_amount, 0)) as numeric(28,6)) as usage_amount,\n        cast(sum(coalesce(normalized_usage_amount, 0)) as numeric(28,6)) as normalized_usage_amount,\n        cast(max(normalization_factor) as numeric(28,6)) as normalization_factor,\n\n        \n        cast(sum(coalesce(blended_cost, 0)) as numeric(28,6)) as blended_cost,\n        cast(sum(coalesce(unblended_cost, 0)) as numeric(28,6)) as unblended_cost,\n        cast(sum(coalesce(public_on_demand_cost, 0)) as numeric(28,6)) as public_on_demand_cost,\n        cast(avg(blended_rate) as numeric(28,6)) as avg_blended_rate,\n        cast(avg(unblended_rate) as numeric(28,6)) as avg_unblended_rate,\n        cast(avg(public_on_demand_rate) as numeric(28,6)) as avg_public_on_demand_rate,\n        cast(count(*) as numeric(28,6)) as count_line_items,\n\n        \n        cast(max(reservation_amortized_upfront_cost_for_usage) as numeric(28,6)) as reservation_amortized_upfront_cost_for_usage,\n        cast(max(reservation_amortized_upfront_fee_for_billing_period) as numeric(28,6)) as reservation_amortized_upfront_fee_for_billing_period,\n        cast(max(reservation_effective_cost) as numeric(28,6)) as reservation_effective_cost,\n        cast(max(number_of_reservations) as numeric(28,6)) as number_of_reservations,\n        cast(max(normalized_units_per_reservation) as numeric(28,6)) as normalized_units_per_reservation,\n        cast(max(units_per_reservation) as numeric(28,6)) as units_per_reservation,\n        cast(max(total_reserved_normalized_units) as numeric(28,6)) as total_reserved_normalized_units,\n        cast(max(total_reserved_units) as numeric(28,6)) as total_reserved_units,\n        \n        cast(max(reservation_recurring_fee_for_usage) as numeric(28,6)) as reservation_recurring_fee_for_usage,\n        cast(min(reservation_unused_amortized_upfront_fee_for_billing_period) as numeric(28,6)) as reservation_unused_amortized_upfront_fee_for_billing_period,\n        cast(min(reservation_unused_normalized_unit_quantity) as numeric(28,6)) as reservation_unused_normalized_unit_quantity,\n        cast(min(reservation_unused_quantity) as numeric(28,6)) as reservation_unused_quantity,\n        cast(min(reservation_unused_recurring_fee) as numeric(28,6)) as reservation_unused_recurring_fee,\n        cast(max(reservation_upfront_value) as numeric(28,6)) as reservation_upfront_value,\n\n        \n        cast(max(savings_plan_amortized_upfront_commitment_for_billing_period) as numeric(28,6)) as savings_plan_amortized_upfront_commitment_for_billing_period,\n        cast(max(savings_plan_recurring_commitment_for_billing_period) as numeric(28,6)) as savings_plan_recurring_commitment_for_billing_period,\n        cast(max(savings_plan_effective_cost) as numeric(28,6)) as savings_plan_effective_cost,\n        cast(max(savings_plan_rate) as numeric(28,6)) as savings_plan_rate,\n        cast(max(savings_plan_total_commitment_to_date) as numeric(28,6)) as savings_plan_total_commitment_to_date,\n        cast(max(savings_plan_used_commitment) as numeric(28,6)) as savings_plan_used_commitment \n\n    from source_report\n    left join billing_account_names\n        on source_report.bill_payer_account_id = billing_account_names.bill_payer_account_id\n        and source_report.source_relation = billing_account_names.source_relation\n    left join usage_account_names\n        on source_report.usage_account_id = usage_account_names.usage_account_id\n        and source_report.source_relation = usage_account_names.source_relation\n\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41\n),\n\nfinal as (select \n        *, \n        md5(cast(coalesce(cast(source_relation as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(report as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_start_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_end_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(billing_period_start_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(billing_period_end_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_account_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_account_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(bill_payer_account_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(bill_payer_account_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invoice_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(invoicing_entity as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(billing_entity as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(bill_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(line_item_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tax_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(purchase_option as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pricing_term as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_fee_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_fee_description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pricing_unit as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(currency_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(line_item_description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_service_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_family as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(operation as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(instance_family as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(instance_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(location as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(location_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(region_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(availability_zone as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(from_location as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(from_location_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(from_region_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(to_location as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(to_location_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(to_region_code as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_key\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_overview\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.551036Z", "completed_at": "2024-07-29T20:36:04.570881Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.571366Z", "completed_at": "2024-07-29T20:36:04.571389Z"}], "thread_id": "Thread-3", "execution_time": 0.022216796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aws_cloud_cost.aws_cloud_cost__daily_instance_report", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_overview\"\n),\n\nfields as (\n\n    select \n        source_relation,\n        report,\n        usage_start_date as usage_date,\n        billing_period_start_date,\n        billing_period_end_date,\n        usage_account_id,\n        usage_account_name,\n        bill_payer_account_id,\n        bill_payer_account_name,\n        currency_code,\n        usage_type,\n\n        \n\n        count(distinct product_service_code) as count_products,\n        count(distinct region_code) as count_regions,\n        sum(coalesce(usage_amount, 0)) as usage_amount,\n        sum(coalesce(normalized_usage_amount, 0)) as normalized_usage_amount,\n        sum(coalesce(total_reserved_units, 0)) as total_reserved_units, -- use this for size-flexible Reserved Instances\n        sum(coalesce(blended_cost, 0)) as total_blended_cost,\n        sum(coalesce(unblended_cost, 0)) as total_unblended_cost,\n        sum(coalesce(public_on_demand_cost, 0)) as total_public_on_demand_cost\n\n        \n        \n    from base \n    group by 1,2,3,4,5,6,7,8,9,10,11\n),\n\nfinal as (\n\n    select\n        *,\n        \n        md5(cast(coalesce(cast(source_relation as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(report as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(billing_period_start_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(billing_period_end_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_account_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_account_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(bill_payer_account_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(bill_payer_account_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(currency_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_key\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_instance_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.556070Z", "completed_at": "2024-07-29T20:36:04.571964Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.572616Z", "completed_at": "2024-07-29T20:36:04.572622Z"}], "thread_id": "Thread-4", "execution_time": 0.0227200984954834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aws_cloud_cost.aws_cloud_cost__daily_product_report", "compiled": true, "compiled_code": "with base as (\n\n    select *\n    from \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_overview\"\n),\n\nfields as (\n\n    select \n        source_relation,\n        report,\n        usage_start_date as usage_date,\n        billing_period_start_date,\n        billing_period_end_date,\n        usage_account_id,\n        usage_account_name,\n        bill_payer_account_id,\n        bill_payer_account_name,\n        currency_code,\n        product_code,\n        product_name,\n\n        \n\n        count(distinct region_code) as count_regions,\n        count(distinct usage_type) as count_instances,\n        sum(coalesce(usage_amount, 0)) as usage_amount,\n        sum(coalesce(normalized_usage_amount, 0)) as normalized_usage_amount,\n        sum(coalesce(total_reserved_units, 0)) as total_reserved_units, -- use this for size-flexible Reserved Instances\n        sum(coalesce(blended_cost, 0)) as total_blended_cost,\n        sum(coalesce(unblended_cost, 0)) as total_unblended_cost,\n        sum(coalesce(public_on_demand_cost, 0)) as total_public_on_demand_cost\n\n        \n\n    from base \n    group by 1,2,3,4,5,6,7,8,9,10,11,12\n),\n\nfinal as (\n\n    select\n        *,\n        \n        md5(cast(coalesce(cast(source_relation as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(report as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(billing_period_start_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(billing_period_end_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_account_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_account_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(bill_payer_account_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(bill_payer_account_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(currency_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_code as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(product_name as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_key\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_product_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.566596Z", "completed_at": "2024-07-29T20:36:04.572391Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.573352Z", "completed_at": "2024-07-29T20:36:04.573355Z"}], "thread_id": "Thread-2", "execution_time": 0.022778749465942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aws_cloud_cost.unique_aws_cloud_cost__daily_overview_unique_key.b9df28f070", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    unique_key as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_overview\"\nwhere unique_key is not null\ngroup by unique_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.560365Z", "completed_at": "2024-07-29T20:36:04.573130Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.574239Z", "completed_at": "2024-07-29T20:36:04.574242Z"}], "thread_id": "Thread-1", "execution_time": 0.023878812789916992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aws_cloud_cost.not_null_aws_cloud_cost__daily_overview_unique_key.ffdd51a6a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_key\nfrom \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_overview\"\nwhere unique_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.576616Z", "completed_at": "2024-07-29T20:36:04.589134Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.589429Z", "completed_at": "2024-07-29T20:36:04.589436Z"}], "thread_id": "Thread-3", "execution_time": 0.014653921127319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aws_cloud_cost.not_null_aws_cloud_cost__daily_instance_report_unique_key.4773201f30", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_key\nfrom \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_instance_report\"\nwhere unique_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.580393Z", "completed_at": "2024-07-29T20:36:04.589888Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.590135Z", "completed_at": "2024-07-29T20:36:04.590139Z"}], "thread_id": "Thread-4", "execution_time": 0.015092849731445312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aws_cloud_cost.unique_aws_cloud_cost__daily_instance_report_unique_key.1a91a0f847", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    unique_key as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_instance_report\"\nwhere unique_key is not null\ngroup by unique_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.586082Z", "completed_at": "2024-07-29T20:36:04.590677Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.590901Z", "completed_at": "2024-07-29T20:36:04.590904Z"}], "thread_id": "Thread-1", "execution_time": 0.014766931533813477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aws_cloud_cost.unique_aws_cloud_cost__daily_product_report_unique_key.0f1e33814d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    unique_key as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_product_report\"\nwhere unique_key is not null\ngroup by unique_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-29T20:36:04.583297Z", "completed_at": "2024-07-29T20:36:04.591275Z"}, {"name": "execute", "started_at": "2024-07-29T20:36:04.591519Z", "completed_at": "2024-07-29T20:36:04.591522Z"}], "thread_id": "Thread-2", "execution_time": 0.015994787216186523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aws_cloud_cost.not_null_aws_cloud_cost__daily_product_report_unique_key.491d2fff1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect unique_key\nfrom \"postgres\".\"aws_cloud_cost_docs_aws_cloud_cost_dev\".\"aws_cloud_cost__daily_product_report\"\nwhere unique_key is null\n\n\n", "relation_name": null}], "elapsed_time": 3.869141101837158, "args": {"print": true, "partial_parse": true, "use_colors": true, "log_level": "info", "introspect": true, "log_level_file": "debug", "quiet": false, "write_json": true, "log_path": "/Users/jamie.rodriguez/Desktop/dbt_repos/AWS_Cloud_Cost/dbt_aws_cloud_cost/integration_tests/logs", "project_dir": "/Users/jamie.rodriguez/Desktop/dbt_repos/AWS_Cloud_Cost/dbt_aws_cloud_cost/integration_tests", "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "strict_mode": false, "exclude": [], "static_parser": true, "favor_state": false, "populate_cache": true, "log_format_file": "debug", "show_resource_report": false, "profiles_dir": "/Users/jamie.rodriguez/.dbt", "partial_parse_file_diff": true, "vars": {}, "cache_selected_only": false, "invocation_command": "dbt docs generate", "require_explicit_package_overrides_for_builtin_materializations": true, "static": false, "version_check": true, "use_colors_file": true, "select": [], "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "printer_width": 80, "compile": true, "defer": false, "empty_catalog": false, "indirect_selection": "eager", "log_format": "default", "which": "generate", "source_freshness_run_project_hooks": false, "send_anonymous_usage_stats": true, "require_resource_names_without_spaces": false}}