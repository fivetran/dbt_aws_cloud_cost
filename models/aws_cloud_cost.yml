version: 2

models:
  - name: aws_cloud_cost__daily_overview
    description: >
      Aggregation of the [Standard](https://docs.aws.amazon.com/cur/latest/userguide/dataexports-create-standard.html) Cost & Usage Report (2.0) exported from AWS.
      Includes commonly analyzed dimensions, all available metrics, and fields added via the `aws_cloud_cost_report_pass_through_columns` variable.
    columns:
      - name: unique_key
        description: Surrogate key hashed on all dimensions in this model.
        data_tests:
          - unique
          - not_null

      - name: source_relation
        description: "{{ doc('source_relation') }}"

      - name: report
        description: "{{ doc('report') }}"

      - name: bill_type
        description: '{{ doc("bill_bill_type") }}'

      - name: billing_entity
        description: '{{ doc("bill_billing_entity") }}'

      - name: billing_period_end_date
        description: '{{ doc("bill_billing_period_end_date") }}'

      - name: billing_period_start_date
        description: '{{ doc("bill_billing_period_start_date") }}'

      - name: invoice_id
        description: '{{ doc("bill_invoice_id") }}'

      - name: invoicing_entity
        description: '{{ doc("bill_invoicing_entity") }}'

      - name: bill_payer_account_id
        description: '{{ doc("bill_payer_account_id") }}'

      - name: availability_zone
        description: '{{ doc("line_item_availability_zone") }}'

      - name: blended_cost
        description: '{{ doc("line_item_blended_cost") }}'

      - name: avg_blended_rate
        description: '{{ doc("line_item_blended_rate") }}'

      - name: currency_code
        description: '{{ doc("line_item_currency_code") }}'

      - name: line_item_description
        description: '{{ doc("line_item_line_item_description") }}'

      - name: line_item_type
        description: '{{ doc("line_item_line_item_type") }}'

      - name: normalization_factor
        description: '{{ doc("line_item_normalization_factor") }}'

      - name: normalized_usage_amount
        description: '{{ doc("line_item_normalized_usage_amount") }}'

      - name: operation
        description: '{{ doc("line_item_operation") }}'

      - name: product_code
        description: '{{ doc("line_item_product_code") }}'

      - name: tax_type
        description: '{{ doc("line_item_tax_type") }}'

      - name: unblended_cost
        description: '{{ doc("line_item_unblended_cost") }}'

      - name: avg_unblended_rate
        description: '{{ doc("line_item_unblended_rate") }}'

      - name: usage_account_id
        description: '{{ doc("line_item_usage_account_id") }}'

      - name: usage_amount
        description: '{{ doc("line_item_usage_amount") }}'

      - name: usage_end_date
        description: '{{ doc("line_item_usage_end_date") }}'

      - name: usage_start_date
        description: '{{ doc("line_item_usage_start_date") }}'

      - name: usage_type
        description: '{{ doc("line_item_usage_type") }}'

      - name: public_on_demand_cost
        description: '{{ doc("pricing_public_on_demand_cost") }}'

      - name: avg_public_on_demand_rate
        description: '{{ doc("pricing_public_on_demand_rate") }}'

      - name: purchase_option
        description: '{{ doc("pricing_purchase_option") }}'

      - name: pricing_term
        description: '{{ doc("pricing_term") }}'

      - name: pricing_unit
        description: '{{ doc("pricing_unit") }}'

      - name: product_fee_code
        description: '{{ doc("product_fee_code") }}'

      - name: product_fee_description
        description: '{{ doc("product_fee_description") }}'

      - name: from_location
        description: '{{ doc("product_from_location") }}'

      - name: from_location_type
        description: '{{ doc("product_from_location_type") }}'

      - name: from_region_code
        description: '{{ doc("product_from_region_code") }}'

      - name: instance_family
        description: '{{ doc("product_instance_family") }}'

      - name: instance_type
        description: '{{ doc("product_instance_type") }}'

      - name: location
        description: '{{ doc("product_location") }}'

      - name: location_type
        description: '{{ doc("product_location_type") }}'

      - name: product_family
        description: '{{ doc("product_product_family") }}'

      - name: product_name
        description: '{{ doc("product_product_name") }}'

      - name: region_code
        description: '{{ doc("product_region_code") }}'

      - name: product_service_code
        description: '{{ doc("product_servicecode") }}'

      - name: to_location
        description: '{{ doc("product_to_location") }}'

      - name: to_location_type
        description: '{{ doc("product_to_location_type") }}'

      - name: to_region_code
        description: '{{ doc("product_to_region_code") }}'

      - name: reservation_amortized_upfront_fee_for_billing_period
        description: '{{ doc("reservation_amortized_upfront_fee_for_billing_period") }}'

      - name: normalized_units_per_reservation
        description: '{{ doc("reservation_normalized_units_per_reservation") }}'

      - name: number_of_reservations
        description: '{{ doc("reservation_number_of_reservations") }}'

      - name: total_reserved_normalized_units
        description: '{{ doc("reservation_total_reserved_normalized_units") }}'

      - name: total_reserved_units
        description: '{{ doc("reservation_total_reserved_units") }}'

      - name: units_per_reservation
        description: '{{ doc("reservation_units_per_reservation") }}'

      - name: reservation_unused_amortized_upfront_fee_for_billing_period
        description: '{{ doc("reservation_unused_amortized_upfront_fee_for_billing_period") }}'

      - name: reservation_unused_normalized_unit_quantity
        description: '{{ doc("reservation_unused_normalized_unit_quantity") }}'

      - name: reservation_unused_quantity
        description: '{{ doc("reservation_unused_quantity") }}'

      - name: reservation_unused_recurring_fee
        description: '{{ doc("reservation_unused_recurring_fee") }}'

      - name: reservation_upfront_value
        description: '{{ doc("reservation_upfront_value") }}'

      - name: savings_plan_effective_cost
        description: '{{ doc("savings_plan_savings_plan_effective_cost") }}'

      - name: savings_plan_rate
        description: '{{ doc("savings_plan_savings_plan_rate") }}'

      - name: bill_payer_account_name
        description: '{{ doc("bill_payer_account_name") }}'

      - name: usage_account_name
        description: '{{ doc("line_item_usage_account_name") }}'

      - name: reservation_recurring_fee_for_usage
        description: '{{ doc("reservation_recurring_fee_for_usage") }}'

      - name: savings_plan_recurring_commitment_for_billing_period
        description: '{{ doc("savings_plan_recurring_commitment_for_billing_period") }}'

      - name: savings_plan_used_commitment
        description: '{{ doc("savings_plan_used_commitment") }}'

      - name: reservation_amortized_upfront_cost_for_usage
        description: '{{ doc("reservation_amortized_upfront_cost_for_usage") }}'

      - name: reservation_effective_cost
        description: '{{ doc("reservation_effective_cost") }}'

      - name: savings_plan_amortized_upfront_commitment_for_billing_period
        description: '{{ doc("savings_plan_amortized_upfront_commitment_for_billing_period") }}'

      - name: savings_plan_total_commitment_to_date
        description: '{{ doc("savings_plan_total_commitment_to_date") }}'

      - name: count_line_items
        description: Count of distinct line items.

  - name: aws_cloud_cost__daily_product_report
    description: >
      Daily view of product usage + accrued costs for each account's billing period.
    columns:
      - name: unique_key
        description: Surrogate key hashed on all dimensions in this model.
        data_tests:
          - unique
          - not_null

      - name: source_relation
        description: "{{ doc('source_relation') }}"

      - name: report
        description: "{{ doc('report') }}"

      - name: usage_date
        description: "{{ doc('line_item_usage_start_date') }}"

      - name: billing_period_start_date
        description: "{{ doc('bill_billing_period_start_date') }}"

      - name: billing_period_end_date
        description: "{{ doc('bill_billing_period_end_date') }}"

      - name: usage_account_id
        description: "{{ doc('line_item_usage_account_id') }}"

      - name: usage_account_name
        description: "{{ doc('line_item_usage_account_name') }}"

      - name: bill_payer_account_id
        description: "{{ doc('bill_payer_account_id') }}"

      - name: bill_payer_account_name
        description: "{{ doc('bill_payer_account_name') }}"

      - name: currency_code
        description: "{{ doc('line_item_currency_code') }}"

      - name: pricing_unit
        description: "{{ doc('pricing_unit') }}"

      - name: product_code
        description: "{{ doc('line_item_product_code') }}"

      - name: product_name
        description: "{{ doc('product_product_name') }}"

      - name: count_regions
        description: Count of distinct regions associated with product usage on this day.

      - name: count_instances
        description: Count of distinct instances associated with product usage on this day.

      - name: usage_amount
        description: "{{ doc('line_item_usage_amount') }}"

      - name: normalized_usage_amount
        description: "{{ doc('line_item_normalized_usage_amount') }}"

      - name: total_blended_cost
        description: "{{ doc('line_item_blended_cost') }}"

      - name: total_unblended_cost
        description: "{{ doc('line_item_unblended_cost') }}"

      - name: total_public_on_demand_cost
        description: "{{ doc('pricing_public_on_demand_cost') }}"

      - name: anniversary_blended_cost
        description: Blended costs associated with `Anniversary` bill types. Part of `total_blended_cost`.

      - name: anniversary_unblended_cost
        description: Unlended costs associated with `Anniversary` bill types. Part of `total_unblended_cost`.

      - name: anniversary_public_on_demand_cost
        description: Public on-demand costs associated with `Anniversary` bill types. Part of `total_public_on_demand_cost`.
        
      - name: purchase_blended_cost
        description: Blended costs associated with `Purchase` bill types. Part of `total_blended_cost`.

      - name: purchase_unblended_cost
        description: Unlended costs associated with `Purchase` bill types. Part of `total_unblended_cost`.

      - name: purchase_public_on_demand_cost
        description: Public on-demand costs associated with `Purchase` bill types. Part of `total_public_on_demand_cost`.

      - name: refund_blended_cost
        description: Blended costs associated with `Refund` bill types. Part of `total_blended_cost`.

      - name: refund_unblended_cost
        description: Unlended costs associated with `Refund` bill types. Part of `total_unblended_cost`.

      - name: refund_public_on_demand_cost
        description: Public on-demand costs associated with `Refund` bill types. Part of `total_public_on_demand_cost`.